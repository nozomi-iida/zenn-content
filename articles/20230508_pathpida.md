---
title: "pathpidaã®ä½¿ã„å‹"
emoji: "ğŸˆ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: true
---

æœ€è¿‘ã€pathpida ã¨ã„ã†ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã„ã¦ã¨ã¦ã‚‚ä¾¿åˆ©ã«æ„Ÿã˜ãŸã®ã§ã€ãã®ä½¿ã„æ–¹ã‚’ã¾ã¨ã‚ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

@[card](https://github.com/aspida/pathpida)

## pathpida ã¨ã¯ï¼Ÿ

pathpida ã¨ã¯ã€next.js ã®ãƒ‘ã‚¹ã‚’è‡ªå‹•ã§ç”Ÿæˆã—ã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹éš›ã«ã€`<Link href="/articles/new">`ã®ã‚ˆã†ã«ã€ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€pathpida ã‚’ä½¿ã†ã¨ã€`<Link href={pagesPath().articles.new.$url()}>`ã®ã‚ˆã†ã«ã€è‡ªå‹•ã§ç”Ÿæˆã—ãŸãƒ‘ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
æ–‡å­—åˆ—ã§ç®¡ç†ã™ã‚‹ã¨ã‚¿ã‚¤ãƒãªã©ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã™ãŒã€pathpida ã‚’ä½¿ã†ã“ã¨ã§å®‰å…¨ã«ãƒ‘ã‚¹ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## å°å…¥æ–¹æ³•

ã¾ãšã€pathpida ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```markdown
yarn add -D pathpida
```

## è¨­å®š

```json:package.json
{
  "scripts": {
    ...,
    "dev:path": "pathpida --ignorepath .gitignore --output ./utils"
  }
}
```

package.json ã® scripts ã«ä¸Šè¨˜ã®ã‚ˆã†ã«è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚
`--ignorepath`ã¯ã€ç„¡è¦–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
`--output`ã¯ã€å‡ºåŠ›å…ˆã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## å®Ÿè¡Œ

```markdown
yarn dev:path
```

ä¸Šè¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€pages ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…ƒã«ã€utils ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã€ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«(`$path.ts`)ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

## ä½¿ç”¨æ–¹æ³•

```ts:pages/index.tsx
import Link from "next/link"
import { pagesPath } from "../lib/$path"

console.log(pagesPath.post.create.$url()) // { pathname: '/post/create' }
console.log(pagesPath.post._pid(1).$url()) // { pathname: '/post/[pid]', query: { pid: 1 }}
console.log(pagesPath.post._slug(["a", "b", "c"]).$url()) // { pathname: '/post//[...slug]', query: { slug: ['a', 'b', 'c'] }}

export default () => {
  const onClick = useCallback(() => {
    router.push(pagesPath.post._pid(1).$url())
  }, [])

  return (
    <>
      <Link href={pagesPath.post._slug(["a", "b", "c"]).$url()} />
      <div onClick={onClick} />
    </>
  )
}
```

ã“ã‚Œã ã‘ã§ç°¡å˜ã«ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã€ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã“ã‹ã‚‰ã¯åŸºæœ¬ã‹ã‚‰å°‘ã—è¸ã¿è¾¼ã‚“ã ä½¿ã„æ–¹ã¾ã§ã‚’ç´¹ä»‹ã—ã¦ã„ãã¾ã™ã€‚

## Query ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ

```ts:pages/post/create.tsx
export type Query = {
  userId: number
  name?: string
}

export default () => <div />
```

```ts:pages/post/[pid].tsx
export type OptionalQuery = {
  limit: number
  label?: string
}

export default () => <div />
```

```ts:pages/index.tsx
import Link from "next/link"
import { pagesPath } from "../lib/$path"

console.log(pagesPath.post.create.$url({ query: { userId: 1 } })) // { pathname: '/post/create', query: { userId: 1 }}
console.log(pagesPath.post.create.$url()) // type error
console.log(pagesPath.post._pid(1).$url()) // { pathname: '/post/[pid]', query: { pid: 1 }}
console.log(pagesPath.post._pid(1).$url({ query: { limit: 10 }, hash: "sample" })) // { pathname: '/post/[pid]', query: { pid: 1, limit: 10 }, hash: 'sample' }

export default () => {
  const onClick = useCallback(() => {
    router.push(pagesPath.post._pid(1).$url())
  }, [])

  return (
    <>
      <Link href={pagesPath.post._slug(["a", "b", "c"]).$url()} />
      <div onClick={onClick} />
    </>
  )
}
```

ä¸Šè¨˜ã®è¨­å®šã ã¨ã€`pagesPath.post.create.tsx`ã®ãƒšãƒ¼ã‚¸ã§ã¯ `userId` ã‚’å¿…é ˆã¨ã—ã¦ã„ã‚‹ã®ã§ pagesPath.post.create.$url()ã®ã‚ˆã†ã«ã€query ã‚’æŒ‡å®šã—ãªã„ã¨ã€å‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

## é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹å ´åˆ

pathpida ã¯`public/**`ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚‚ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```json:package.json
{
  "scripts": {
    ...,
    "dev:path": "pathpida --enableStatic --ignorepath .gitignore --output ./utils"
  }
}
```

`--enableStatic`ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä½¿ç”¨æ–¹æ³•ã¯ãƒšãƒ¼ã‚¸ãƒ‘ã‚¹ã¨åŒã˜ã§ã™ã€‚

```ts:pages/index.tsx
import Link from "next/link"
import { staticPath } from "../lib/$path"

console.log(staticPath.aa_json) // /aa.json

export default () => {
  return (
    <>
      <img src={staticPath.bb.cc_png} />
    </>
  )
}
```
